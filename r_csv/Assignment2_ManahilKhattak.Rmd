---
title: "Assignment 2 Scraping HTML and Save to CSV file"
author: "Manahil Khattak"
date: "2024-06-05"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
## Scraping the CSV Example
We first download rvest() package to scrape data from a webpage
```{r}
library(rvest)

# Define the URL of the Wikipedia page
url <- "https://en.wikipedia.org/wiki/Comma-separated_values"
```
We now read the HTML/URL using the read() which reads the default format of the file.
```{r}
# Read the HTML content of the page

page <- read_html(url)
```
Here we extract the data from the webpage and we split the lines and to create them into data frames for easier reading.
'grepl' - grep logical meaning it selects matches of string.
```{r}
# Extract the CSV example from the page
csv_table <- page %>% html_nodes("pre") %>% html_text() %>% .[grepl("Year,Make,Model,Description,Price", .)]

print(csv_table)


# Split the CSV text into lines

csv_splitline <- strsplit(csv_table, "\n")[[1]]

# Split each line into fields and convert to a data frame

csv_info <- do.call(rbind, lapply(csv_splitline, function(x) strsplit(x, ",")[[1]]))
csvframe <- as.data.frame(csv_info, stringsAsFactors = FALSE)

# Set the first row as column names and remove it from the data

colnames(csvframe) <- csvframe[1, ]
csvframe <- csvframe[-1, ]
```
We now save the data frame to a csv file by using the write.csv() function. 
```{r}
# Save the data frame to a CSV file

write.csv(csvframe, file = "r_csv/vehicle.csv", row.names = FALSE)

cat("CSV file has been saved.\n")
```

## Display Result
```{r}
print(csvframe)
```

### Printing the data from the csv file
```{r, echo=TRUE, message=FALSE}
# Knitr extracts the r code from a file
library(knitr)
data <- read.csv("vehicle.csv")
subset_data <- head(data)
print(subset_data)


```



